/*
	ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‘ â€”â€”â€”â€” ç›¸æ¯”èµ·è§‚å¯Ÿè€…æ¨¡å¼å¤šäº†ä¸ªã€è°ƒåº¦ä¸­å¿ƒã€‘
		1.åŒ…å«ã€è¢«è§‚å¯Ÿç›®æ ‡ã€‘å’Œã€è§‚å¯Ÿè€…æœ¬èº«ã€‘ä¸¤ä¸ªéƒ¨åˆ†, ä¸¤è€…ä¹‹é—´æ²¡æœ‰ç›´æ¥è”ç³», é€šè¿‡ã€è°ƒåº¦ä¸­å¿ƒã€‘è¿›è¡Œé€šä¿¡
		2.å¯ä»¥äº‹ä»¶ç»†åˆ†, ç»‘å®šäº‹ä»¶åï¼ˆæœ‰ç‚¹åƒç­–ç•¥æ¨¡å¼ï¼‰
*/


// ğŸŒ°ä¾‹å­ä¸€(æ¦‚å¿µç†è§£, è¿˜æ²¡æœ‰ç»†åˆ†äº‹ä»¶çš„è®¢é˜…æ¨¡å¼): â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
const PubSub = {
	list: [], //ğŸ‘€æ”¶é›†æ‰€æœ‰ã€è®¢é˜…è€…ã€‘çš„æ•°ç»„

	publish (){
		this.list.forEach(item => item()) //éå†æ‰§è¡Œæ¯ä¸€ä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„æ–¹æ³•
	},

	subscribe (fn){
		this.list.push(fn) //æŠŠäº‹ä»¶æ”¶é›†åˆ°ã€list æ•°ç»„ã€‘ä¸­
	}
}


function testA() {
	console.log('testA')
}

function testB() {
	console.log('testB')
}


//è®¢é˜…è€…,å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå®ä¾‹åŒ–çš„å¯¹è±¡
PubSub.subscribe(testA)  //ğŸ”¥ğŸ”¥æ³¨å†Œäº‹ä»¶
PubSub.subscribe(testB) //ğŸ”¥ğŸ”¥æ³¨å†Œäº‹ä»¶

// PubSub.publish() //æ‰§è¡Œå‘å¸ƒè€…æ–¹æ³•, é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…æ‰§è¡Œæ–¹æ³•




// ğŸŒ°ä¾‹å­äºŒ(æœ‰ç»†åˆ†äº‹ä»¶çš„è®¢é˜…æ¨¡å¼): â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
const PubSub_2 = {
	message: {},  //ğŸ‘€æ”¶é›†æ‰€æœ‰ã€è®¢é˜…è€…ã€‘çš„æ•°ç»„

	// è°ƒåº¦ä¸­å¿ƒ
	publish (type, data){
		if(!this.message[type]) { //å¦‚æœæ²¡æœ‰è¿™ä¸ªäº‹ä»¶, å°±è¿”å›, ä¸æ‰§è¡Œ
			alert('æ²¡æœ‰è¿™ä¸ªäº‹ä»¶');
			return
		}
		
		this.message[type].forEach(item => item(data)) //éå†æ‰§è¡Œæ¯ä¸€ä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„æ–¹æ³•, ç„¶åæŠŠæ•°æ®ä¼ é€’è¿‡å»
	},

	// æ³¨å†Œè®¢é˜…äº‹ä»¶
	subscribe (type, fn){ //ğŸ‘€ç»†åˆ†äº‹ä»¶ï¼ˆ1.äº‹ä»¶å, 2.è®¢é˜…è€…ï¼‰, ç„¶åæŠŠäº‹ä»¶æ”¶é›†åˆ°ã€message å¯¹è±¡ã€‘ä¸­
		if(!this.message[type]) {
			this.message[type] = [fn] //å¦‚æœï¼ˆç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼‰æ²¡æœ‰è¿™ä¸ªäº‹ä»¶, å°±åˆ›å»ºä¸€ä¸ªæ•°ç»„, å¹¶æŠŠè®¢é˜…è€…æ”¾è¿›å»
		} else {
			this.message[type].push(fn) //å¦‚æœï¼ˆç¬¬äºŒæ¬¡æ‰§è¡Œæ—¶ï¼‰æœ‰è¿™ä¸ªäº‹ä»¶, å°±æŠŠè®¢é˜…è€…æ”¾è¿›å»
		}
	},

	// å–æ¶ˆè®¢é˜…äº‹ä»¶
	unSubscribe (type, fn){
		if(!this.message[type]) {//å¦‚æœæ²¡æœ‰å¯¹åº”çš„ç±»å‹
			return
		}

		if(!fn) { //å¦‚æœæ²¡æœ‰ä¼ è¦å–æ¶ˆå“ªä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶, è¿™é‡Œå°±æ˜¯ true, é‚£ä¹ˆä¹…å–æ¶ˆæ‰€æœ‰ã€ğŸ”µæ”¶é›†å®Œçš„äº‹ä»¶ã€‘
			this.message[type] && (this.message = {})// å–æ¶ˆæ‰€æœ‰äº‹ä»¶ ï¼ˆçŸ­è·¯è¿ç®—, åªæœ‰å½“ this.message[type] çš„å€¼ä¸ºçœŸæ—¶ï¼ˆå³ä¸ä¸º nullã€undefinedã€0ã€falseã€ç©ºå­—ç¬¦ä¸²ç­‰å‡å€¼ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„è¯­å¥ï¼‰
			console.log(this.message)
		} else { //å¦‚æœä¼ äº†å¯¹åº”è¦å–æ¶ˆå“ªä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶, é‚£ä¹ˆå°±å–æ¶ˆå¯¹åº”çš„ã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶
			this.message[type] = this.message[type].filter(item => item !== fn) //è¿‡æ»¤æ‰è¦å–æ¶ˆçš„äº‹ä»¶
			console.log(this.message)
		}
	}
}


function testA_2(data) {
	// Açš„ä¸šåŠ¡... æ¯”å¦‚ mouseEnter äº‹ä»¶
	console.log('testA', data)
}

function testB_2(data) {
	// Bçš„ä¸šåŠ¡... æ¯”å¦‚ click äº‹ä»¶
	console.log('testB', data)
}

function testC_3(data) {
	// Bçš„ä¸šåŠ¡... æ¯”å¦‚ mouseOver äº‹ä»¶
	console.log('testC', data)
}


//è®¢é˜…è€…,å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå®ä¾‹åŒ–çš„å¯¹è±¡
PubSub_2.subscribe('A', testA_2)  //ğŸ”¥ğŸ”¥æ³¨å†Œäº‹ä»¶
PubSub_2.subscribe('B', testB_2) //ğŸ”¥ğŸ”¥æ³¨å†Œäº‹ä»¶
PubSub_2.subscribe('C', testC_3) //ğŸ”¥ğŸ”¥æ³¨å†Œäº‹ä»¶

// PubSub_2.unSubscribe('C') //ğŸŒŸå–æ¶ˆè®¢é˜…æ‰€æœ‰äº‹ä»¶
PubSub_2.unSubscribe('C', testC_3) //ğŸŒŸå–æ¶ˆè®¢é˜… C äº‹ä»¶


PubSub_2.publish('A', 66)
PubSub_2.publish('C', 'ä¼ å…¥ä¸€ä¸ª data æ•°æ®') //æ‰§è¡Œå‘å¸ƒè€…æ–¹æ³•, é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…æ‰§è¡Œæ–¹æ³•
// PubSub_2.publish('D') //æ²¡æœ‰è¿™ä¸ªäº‹ä»¶




// ğŸŒ°ä¾‹å­ä¸‰(ç”¨æœ‰ç»†åˆ†äº‹ä»¶çš„è®¢é˜…æ¨¡å¼æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„ä¾‹å­): â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
const PubSub_3 = {
	message: {},  //ğŸ‘€æ”¶é›†æ‰€æœ‰ã€è®¢é˜…è€…ã€‘çš„æ•°ç»„

	// è°ƒåº¦ä¸­å¿ƒ
	publish (type, data){
		if(!this.message[type]) { //å¦‚æœæ²¡æœ‰è¿™ä¸ªäº‹ä»¶, å°±è¿”å›, ä¸æ‰§è¡Œ
			alert('æ²¡æœ‰è¿™ä¸ªäº‹ä»¶');
			return
		}
		
		this.message[type].forEach(item => item(data)) //éå†æ‰§è¡Œæ¯ä¸€ä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„æ–¹æ³•, ç„¶åæŠŠæ•°æ®ä¼ é€’è¿‡å»
	},

	// æ³¨å†Œè®¢é˜…äº‹ä»¶
	subscribe (type, fn){ //ğŸ‘€ç»†åˆ†äº‹ä»¶ï¼ˆ1.äº‹ä»¶å, 2.è®¢é˜…è€…ï¼‰, ç„¶åæŠŠäº‹ä»¶æ”¶é›†åˆ°ã€message å¯¹è±¡ã€‘ä¸­
		if(!this.message[type]) {
			this.message[type] = [fn] //å¦‚æœï¼ˆç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼‰æ²¡æœ‰è¿™ä¸ªäº‹ä»¶, å°±åˆ›å»ºä¸€ä¸ªæ•°ç»„, å¹¶æŠŠè®¢é˜…è€…æ”¾è¿›å»
		} else {
			this.message[type].push(fn) //å¦‚æœï¼ˆç¬¬äºŒæ¬¡æ‰§è¡Œæ—¶ï¼‰æœ‰è¿™ä¸ªäº‹ä»¶, å°±æŠŠè®¢é˜…è€…æ”¾è¿›å»
		}
	},

	// å–æ¶ˆè®¢é˜…äº‹ä»¶
	unSubscribe (type, fn){
		if(!this.message[type]) {//å¦‚æœæ²¡æœ‰å¯¹åº”çš„ç±»å‹
			return
		}

		if(!fn) { //å¦‚æœæ²¡æœ‰ä¼ è¦å–æ¶ˆå“ªä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶, è¿™é‡Œå°±æ˜¯ true, é‚£ä¹ˆä¹…å–æ¶ˆæ‰€æœ‰ã€ğŸ”µæ”¶é›†å®Œçš„äº‹ä»¶ã€‘
			this.message[type] && (this.message = {})// å–æ¶ˆæ‰€æœ‰äº‹ä»¶ ï¼ˆçŸ­è·¯è¿ç®—, åªæœ‰å½“ this.message[type] çš„å€¼ä¸ºçœŸæ—¶ï¼ˆå³ä¸ä¸º nullã€undefinedã€0ã€falseã€ç©ºå­—ç¬¦ä¸²ç­‰å‡å€¼ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„è¯­å¥ï¼‰
			console.log(this.message)
		} else { //å¦‚æœä¼ äº†å¯¹åº”è¦å–æ¶ˆå“ªä¸ªã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶, é‚£ä¹ˆå°±å–æ¶ˆå¯¹åº”çš„ã€ğŸ‘€è®¢é˜…è€…ã€‘çš„äº‹ä»¶
			this.message[type] = this.message[type].filter(item => item !== fn) //è¿‡æ»¤æ‰è¦å–æ¶ˆçš„äº‹ä»¶
			console.log(this.message)
		}
	}
}


// ğŸŒŸæ³¨å†Œäº‹ä»¶(é¢åŒ…å±‘è®¢é˜…è€…)
PubSub_3.subscribe('updateBread', function(data){ 
	console.log('è®¢é˜…è€…æ”¶åˆ°é€šçŸ¥äº†')
	console.log(data)//æ”¶åˆ°ä¿¡æ¯
	// ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­æœ‰ data å°±æ˜¾ç¤ºä¸º data, æ²¡æœ‰å°±æ˜¾ç¤ºä¸º 'é¦–é¡µ'
	document.querySelector('.bread').innerHTML = data
})

// ğŸŒŸæ³¨å†Œäº‹ä»¶(header è®¢é˜…è€…)
PubSub_3.subscribe('updateHeader', function(data){ 
	console.log('è®¢é˜…è€…æ”¶åˆ°é€šçŸ¥äº†')
	console.log(data)//æ”¶åˆ°ä¿¡æ¯
	// header æ˜¾ç¤ºä¸º data
	document.querySelector('.header').innerHTML = data
})


//ğŸ”¥ğŸ”¥æ‰¾åˆ°æ‰€æœ‰ li ã€ğŸ”µè¢«è§‚å¯Ÿå¯¹è±¡ã€‘, ç»Ÿä¸€æ·»åŠ äº‹ä»¶å¹¶è§¦å‘é€šçŸ¥
let oLi = document.querySelectorAll('.left li') 
for(let i = 0; i < oLi.length; i++) {
	oLi[i].addEventListener('click', function(){ //ç»™æ¯ä¸€ä¸ª li æ·»åŠ ç‚¹å‡»äº‹ä»¶
		// console.log(this.innerHTML) // æ‹¿åˆ° tab çš„æ–‡æœ¬å†…å®¹, this å°±æ˜¯å½“å‰ç‚¹å‡»çš„ li
		PubSub_3.publish('updateBread', this.innerHTML)//ğŸš€éœ€è¦å¯¹åº”å¥½ã€äº‹ä»¶åã€‘å’Œã€æ•°æ®ã€‘ï¼æŠŠè¿™ä¸¤ä¸ªæ¶ˆæ¯å‘é€è¿‡å»å°±è¡Œäº†
		PubSub_3.publish('updateHeader', this.innerHTML)//ğŸš€éœ€è¦å¯¹åº”å¥½ã€äº‹ä»¶åã€‘å’Œã€æ•°æ®ã€‘ï¼æŠŠè¿™ä¸¤ä¸ªæ¶ˆæ¯å‘é€è¿‡å»å°±è¡Œäº†)
	})
}
